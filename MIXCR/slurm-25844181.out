INFO	2023-05-03 17:19:46	SamToFastq	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    SamToFastq -INPUT /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/input/bam/pt2229-DX1BM-ALLBULK-DNCD1aNeg_dedup.bam -OUTPUT_DIR /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/input/fastq -RG_TAG ID -OUTPUT_PER_RG true
**********


17:19:46.866 INFO  NativeLibraryLoader - Loading libgkl_compression.so from jar:file:/hpc/local/CentOS7/pmc_vanboxtel/bin/picard-2.24.1/picard.jar!/com/intel/gkl/native/libgkl_compression.so
[Wed May 03 17:19:46 CEST 2023] SamToFastq INPUT=/hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/input/bam/pt2229-DX1BM-ALLBULK-DNCD1aNeg_dedup.bam OUTPUT_PER_RG=true RG_TAG=ID OUTPUT_DIR=/hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/input/fastq    COMPRESS_OUTPUTS_PER_RG=false RE_REVERSE=true INTERLEAVE=false INCLUDE_NON_PF_READS=false CLIPPING_MIN_LENGTH=0 READ1_TRIM=0 READ2_TRIM=0 INCLUDE_NON_PRIMARY_ALIGNMENTS=false VERBOSITY=INFO QUIET=false VALIDATION_STRINGENCY=STRICT COMPRESSION_LEVEL=5 MAX_RECORDS_IN_RAM=500000 CREATE_INDEX=false CREATE_MD5_FILE=false GA4GH_CLIENT_SECRETS=client_secrets.json USE_JDK_DEFLATER=false USE_JDK_INFLATER=false
[Wed May 03 17:19:46 CEST 2023] Executing as rhagelaar@n0091.compute.hpc on Linux 3.10.0-1160.83.1.el7.x86_64 amd64; Java HotSpot(TM) 64-Bit Server VM 1.8.0_60-b27; Deflater: Intel; Inflater: Intel; Provider GCS is not available; Picard version: 2.24.1
INFO	2023-05-03 17:19:56	SamToFastq	Processed     1,000,000 records.  Elapsed time: 00:00:09s.  Time for last 1,000,000:    9s.  Last read position: 7:38,458,833
INFO	2023-05-03 17:20:05	SamToFastq	Processed     2,000,000 records.  Elapsed time: 00:00:18s.  Time for last 1,000,000:    8s.  Last read position: 14:22,733,990
INFO	2023-05-03 17:20:13	SamToFastq	Processed     3,000,000 records.  Elapsed time: 00:00:26s.  Time for last 1,000,000:    8s.  Last read position: 22:23,044,382
[Wed May 03 17:20:16 CEST 2023] picard.sam.SamToFastq done. Elapsed time: 0.50 minutes.
Runtime.totalMemory()=10123476992
To get help, see http://broadinstitute.github.io/picard/index.html#GettingHelp
Exception in thread "main" htsjdk.samtools.SAMFormatException: SAM validation error: ERROR::MATE_NOT_FOUND:Found 62746 unpaired mates
	at htsjdk.samtools.SAMUtils.processValidationError(SAMUtils.java:469)
	at picard.sam.SamToFastq.doWork(SamToFastq.java:225)
	at picard.cmdline.CommandLineProgram.instanceMain(CommandLineProgram.java:304)
	at picard.cmdline.PicardCommandLine.instanceMain(PicardCommandLine.java:103)
	at picard.cmdline.PicardCommandLine.main(PicardCommandLine.java:113)
/hpc/pmc_vanboxtel/projects/TallFlow/2_Code/MIXCR/
IMPORTANT: MiXCR will use at most 4759MB of RAM,
           use -Xmx to change automatically set heap size (i.e. -Xmx50g to set heap size to 50 Gb)
====================
Running:
mixcr align --report /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.align.report.txt --json-report /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.align.report.json --preset rnaseq-full-length --dna --species hsa /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/input/fastq/Merged/pt2229-DX1BM-ALLBULK-DNCD1aNeg_R1.fastq /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/input/fastq/Merged/pt2229-DX1BM-ALLBULK-DNCD1aNeg_R2.fastq /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.vdjca
Alignment: 0%
Alignment: 10.3%  ETA: 00:07:47
Alignment: 20.6%  ETA: 00:07:46
Alignment: 30.8%  ETA: 00:06:32
Alignment: 41.1%  ETA: 00:05:15
Alignment: 51.4%  ETA: 00:04:44
Alignment: 61.7%  ETA: 00:03:17
Alignment: 72%  ETA: 00:02:38
Alignment: 82.3%  ETA: 00:01:38
Alignment: 92.5%  ETA: 00:00:38
============== Align Report ==============
Analysis time: 9.3m
Total sequencing reads: 1521874
Successfully aligned reads: 17741 (1.17%)
Alignment failed: no hits (not TCR/IG?): 1231307 (80.91%)
Alignment failed: no CDR3 parts: 153397 (10.08%)
Alignment failed: low total score: 119429 (7.85%)
Overlapped: 155508 (10.22%)
Overlapped and aligned: 310 (0.02%)
Overlapped and not aligned: 155198 (10.2%)
Alignment-aided overlaps, percent of overlapped and aligned: 4 (1.29%)
No CDR3 parts alignments, percent of successfully aligned: 2527 (14.24%)
Partial aligned reads, percent of successfully aligned: 15130 (85.28%)
V gene chimeras: 306 (0.02%)
J gene chimeras: 162 (0.01%)
Paired-end alignment conflicts eliminated: 27 (0%)
Realigned with forced non-floating bound: 2732740 (179.56%)
Realigned with forced non-floating right bound in left read: 5871 (0.39%)
Realigned with forced non-floating left bound in right read: 5871 (0.39%)
TRA chains: 1673 (9.43%)
TRA non-functional: 11 (0.66%)
TRB chains: 3151 (17.76%)
TRB non-functional: 1 (0.03%)
TRD chains: 82 (0.46%)
TRD non-functional: 23 (28.05%)
TRG chains: 130 (0.73%)
TRG non-functional: 25 (19.23%)
TRAD chains: 1455 (8.2%)
TRAD non-functional: 0 (0%)
IGH chains: 4714 (26.57%)
IGH non-functional: 0 (0%)
IGK chains: 3129 (17.64%)
IGK non-functional: 0 (0%)
IGL chains: 3407 (19.2%)
IGL non-functional: 0 (0%)
Trimming report:
  R1 reads trimmed left: 1563 (0.1%)
  R1 reads trimmed right: 2 (0%)
  Average R1 nucleotides trimmed left: 0.0021105558015972413
  Average R1 nucleotides trimmed right: 8.936350841134023E-5
  R2 reads trimmed left: 499 (0.03%)
  R2 reads trimmed right: 8 (0%)
  Average R2 nucleotides trimmed left: 6.899388517052003E-4
  Average R2 nucleotides trimmed right: 1.1170438551417528E-4
====================
Running:
mixcr assemblePartial --report /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.assemblePartial.report.txt --json-report /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.assemblePartial.report.json /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.vdjca /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.passembled.1.vdjca
Building index: 0%
Searching for overlaps: 0%
Searching for overlaps: 95.7%  ETA: 00:00:00
============== AssemblePartial Report ==============
Analysis time: 1.48s
Total alignments analysed: 17740
Number of output alignments: 17734 (99.97%)
Alignments already with CDR3 (no overlapping is performed): 95 (0.54%)
Successfully overlapped alignments: 6 (0.03%)
Left parts with too small N-region (failed to extract k-mer): 2085 (11.75%)
Extracted k-mer diversity: 45750
Dropped due to wildcard in k-mer: 0 (0%)
Dropped due to too short NRegion parts in overlap: 21 (0.12%)
Dropped overlaps with empty N region due to no complete NDN coverage: 0 (0%)
Number of left-side alignments: 11215 (63.22%)
Number of right-side alignments: 3463 (19.52%)
Complex overlaps: 0 (0%)
Over-overlaps: 8 (0.05%)
Partial alignments written to output: 17633 (99.4%)
====================
Running:
mixcr assemblePartial --report /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.assemblePartial.report.txt --json-report /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.assemblePartial.report.json /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.passembled.1.vdjca /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.passembled.2.vdjca
Building index: 0%
Searching for overlaps: 0%
============== AssemblePartial Report ==============
Analysis time: 1.01s
Total alignments analysed: 17734
Number of output alignments: 17734 (100%)
Alignments already with CDR3 (no overlapping is performed): 101 (0.57%)
Successfully overlapped alignments: 0 (0%)
Left parts with too small N-region (failed to extract k-mer): 2085 (11.76%)
Extracted k-mer diversity: 45673
Dropped due to wildcard in k-mer: 0 (0%)
Dropped due to too short NRegion parts in overlap: 17 (0.1%)
Dropped overlaps with empty N region due to no complete NDN coverage: 0 (0%)
Number of left-side alignments: 11209 (63.21%)
Number of right-side alignments: 3456 (19.49%)
Complex overlaps: 0 (0%)
Over-overlaps: 8 (0.05%)
Partial alignments written to output: 17633 (99.43%)
====================
Running:
mixcr extend --report /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.extend.report.txt --json-report /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.extend.report.json /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.passembled.2.vdjca /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.extended.vdjca
Extending alignments: 0%
============== Extend Report ==============
Analysis time: 343ms
Extended alignments count: 10 (0.06%)
V extensions total: 0 (0%)
V extensions with merged targets: 0 (0%)
J extensions total: 10 (0.06%)
J extensions with merged targets: 0 (0%)
V+J extensions: 0 (0%)
Mean V extension length: NaN
Mean J extension length: 6.1
====================
Running:
mixcr assemble --report /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.assemble.report.txt --json-report /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.assemble.report.json /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.extended.vdjca /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.clna
Initialization: progress unknown
Initialization: progress unknown
============== Assemble Report ==============
Analysis time: 475ms
Final clonotype count: 9
Reads used in clonotypes, percent of total: 103 (0.01%)
Average number of reads per clonotype: 11.44
Reads dropped due to the lack of a clone sequence, percent of total: 17634 (1.16%)
Reads dropped due to a too short clonal sequence, percent of total: 0 (0%)
Reads dropped due to low quality, percent of total: 0 (0%)
Reads dropped due to failed mapping, percent of total: 2 (0%)
Reads dropped with low quality clones, percent of total: 0 (0%)
Reads used in clonotypes before clustering, percent of total: 104 (0.01%)
Number of reads used as a core, percent of used: 100 (96.15%)
Mapped low quality reads, percent of used: 4 (3.85%)
Reads clustered in PCR error correction, percent of used: 1 (0.96%)
Reads pre-clustered due to the similar VJC-lists, percent of used: 0 (0%)
Clonotypes dropped as low quality: 0
Clonotypes eliminated by PCR error correction: 1
Clonotypes pre-clustered due to the similar VJC-lists: 0
Clones dropped in post filtering: 0 (0%)
Reads dropped in post filtering: 0.0 (0%)
Alignments filtered by tag prefix: 0 (0%)
TRA chains: 3 (33.33%)
TRA non-functional: 3 (100%)
TRB chains: 2 (22.22%)
TRB non-functional: 0 (0%)
TRD chains: 1 (11.11%)
TRD non-functional: 1 (100%)
TRG chains: 3 (33.33%)
TRG non-functional: 3 (100%)
====================
Running:
mixcr assembleContigs --report /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.assembleContigs.report.txt --json-report /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.assembleContigs.report.json /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.clna /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.contigs.clns
Assembling contigs: 0%
============== AssembleContigs Report ==============
Analysis time: 345ms
Initial clonotype count: 9
Final clonotype count: 9 (100%)
Canceled assemblies: 0 (0%)
Number of premature termination assembly events, percent of number of initial clonotypes: 0.0 (0%)
Longest contig length: 917
Clustered variants: 0 (0%)
Reads in clustered variants: 0.0 (0%)
Reads in divided (newly created) clones: 0.0 (0%)
Clones with ambiguous letters in splitting region: 0 (0%)
Reads in clones with ambiguous letters in splitting region: 0.0 (0%)
Average number of ambiguous letters per clone with ambiguous letters in splitting region: NaN
====================
Running:
mixcr exportClones /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.contigs.clns /hpc/pmc_vanboxtel/projects/TallFlow/3_Output/MIXCR4.3.2/Output/pt2229-DX1BM-ALLBULK-DNCD1aNeg/pt2229-DX1BM-ALLBULK-DNCD1aNeg_Receptor.clones.tsv
Exporting TRB
Exporting clones: 0%
WARNING: Filtered 2 of 9 clones (77.78%).
WARNING: Filtered 28.0 of 103.0 reads (72.82%).
Exporting TRAD
Exporting clones: 0%
WARNING: Filtered 4 of 9 clones (55.56%).
WARNING: Filtered 43.0 of 103.0 reads (58.25%).
Exporting TRG
Exporting clones: 0%
WARNING: Filtered 3 of 9 clones (66.67%).
WARNING: Filtered 32.0 of 103.0 reads (68.93%).
Analysis finished successfully.
IMPORTANT: MiXCR will use at most 9658MB of RAM,
           use -Xmx to change automatically set heap size (i.e. -Xmx50g to set heap size to 50 Gb)
IMPORTANT: MiXCR will use at most 9680MB of RAM,
           use -Xmx to change automatically set heap size (i.e. -Xmx50g to set heap size to 50 Gb)
IMPORTANT: MiXCR will use at most 9669MB of RAM,
           use -Xmx to change automatically set heap size (i.e. -Xmx50g to set heap size to 50 Gb)
